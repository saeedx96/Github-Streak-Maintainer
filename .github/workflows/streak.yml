name: Maintain GitHub Streak Pro +

on:  
  schedule:  
    - cron: '0 5-23/6 * * *'  
  workflow_dispatch:  

permissions:
  contents: write

jobs:  
  build:  
    runs-on: ubuntu-latest  
    steps:  
      - name: Checkout Repo  
        uses: actions/checkout@v3

      - name: Configure Git  
        run: |
          git config --local user.email "228329407+saeedx96@users.noreply.github.com"
          git config --local user.name "saeedx96"

      - name: Update README  
        run: |
          # YEH LINE BADAL DI GAYI HAI (THIS LINE HAS BEEN CHANGED) ðŸ‘‡
          TIMESTAMP=$(TZ="Asia/Karachi" date +"%Y-%m-%d %H:%M:%S")
          COMMIT_MSG=$(shuf -n 1 commit_messages.txt)
          QUOTES=("ðŸ’€ Darkness never sleeps" "ðŸ”¥ Keep the flame alive" "ðŸ‘» Shadows whisper in silence" "âš¡ Power never dies" "ðŸ•¯ï¸ Light in the darkness")
          RANDOM_QUOTE=${QUOTES[$RANDOM % ${#QUOTES[@]}]}

          # Purani history ko preserve karo, sirf nayi row add karo
          if ! grep -q "## ðŸ“… Commit History" README.md; then
            echo -e "## ðŸ“… Commit History\n| # | Date & Time (PKT) | Message | Quote |\n|---|--------------------|---------|-------|" >> README.md
          fi

          # Count existing rows (ignore header lines)
          COUNT=$(grep -c "^|" README.md)
          NEW_COUNT=$((COUNT - 3)) # subtract header lines

          echo "| $NEW_COUNT | $TIMESTAMP | $COMMIT_MSG | $RANDOM_QUOTE |" >> README.md

          git add README.md
          git commit -m "$COMMIT_MSG" || echo "No changes to commit"
          git pull --rebase origin main || git rebase --abort
          git push origin main
